server.host: <%= @host %>
server.port: <%= @port %>
elasticsearch.hosts: [
<% if node['xpack']['enabled'] %>
<% @elasticsearch_hosts.each do |node| %>
  "https://<%= node %>"
<% end %>
<% else %>
<% @elasticsearch_hosts.each do |node| %>
  "http://<%= node %>"
<% end %>
<% end %>
]
elasticsearch.password: <%= @elasticsearch_password %>

<% if node['xpack']['enabled'] %>
# Elasticsearch from/to Kibana

elasticsearch.ssl.certificateAuthorities: /etc/kibana/certs/ca/ca.crt
elasticsearch.ssl.certificate: /etc/kibana/certs/kibana.crt
elasticsearch.ssl.key: /etc/kibana/certs/kibana.key

# Browser from/to Kibana
server.ssl.enabled: <%= @ssl_enabled %>
server.ssl.certificate: /etc/kibana/certs/kibana.crt
server.ssl.key: /etc/kibana/certs/kibana.key
<% end %>

# Elasticsearch authentication
xpack.security.enabled: <%= @xpack_enabled %>
elasticsearch.username: elastic
server.defaultRoute: /app/wazuh
